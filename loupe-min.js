function scaling(e,t,a){return a.width/e}let cc=(e,...t)=>(t.forEach(t=>t(e)),e);const LSIZE=240;window.addEventListener("DOMContentLoaded",()=>{function e(e){(r=cc(new Image,t=>t.src=e.target.value+"/dressed.jpg")).addEventListener("load",()=>{u=scaling(r.naturalWidth,r.naturalHeight,g),n.height=r.naturalHeight*u,l.clearRect(0,0,n.width,n.height),l.drawImage(r,0,0,r.naturalWidth*u,r.naturalHeight*u)}),o=cc(new Image,t=>t.src=e.target.value+"/naked.jpg")}function t(e){move_loupe(e.offsetX||e.layerX,e.offsetY||e.layerY)}let a=document.getElementById("wrap");var n=document.querySelector("#dressed"),d=document.querySelector("#naked"),l=n.getContext("2d");window.dctx=l;var r,o,u,c=d.getContext("2d");window.nctx=c;let i=document.getElementById("dir"),g=a.getBoundingClientRect();n.width=g.width,i.addEventListener("change",e),e({target:{value:i.value}});var s=.5,h={x:0,y:0};move_loupe=((e,t)=>{c.clearRect(0,0,LSIZE,LSIZE),c.drawImage(o,LSIZE/2-e,LSIZE/2-t,o.naturalWidth*u,o.naturalHeight*u),c.globalAlpha=s,c.drawImage(r,LSIZE/2-e,LSIZE/2-t,r.naturalWidth*u,r.naturalHeight*u),c.globalAlpha=1,d.style.top=t-LSIZE/2+"px",d.style.left=e-LSIZE/2+"px",h.x=e,h.y=t}),n.addEventListener("mousemove",t),d.addEventListener("mousemove",function(e){move_loupe(parseFloat(e.target.style.left)+(e.offsetX||e.layerX),Math.max(parseFloat(e.target.style.top)+(e.offsetY||e.layerY),LSIZE/2))}),n.addEventListener("touchmove",e=>{e.preventDefault(),t(e.changedTouches[0])}),d.addEventListener("touchmove",e=>{e.preventDefault(),t(e.changedTouches[0])}),d.addEventListener("wheel",e=>{s+=.001*e.deltaY,move_loupe(h.x,h.y)})});