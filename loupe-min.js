let cc=(e,...t)=>(t.forEach(t=>t(e)),e);const loupe_size=240;function scaling(e,t,a){return console.log([e,a.width]),a.width/e}window.addEventListener("DOMContentLoaded",e=>{let t=document.getElementById("wrap");var a=document.querySelector("#dressed"),n=document.querySelector("#naked"),o=a.getContext("2d");window.dctx=o;var l,d,r,c=n.getContext("2d");window.nctx=c;let i=document.getElementById("dir"),u=t.getBoundingClientRect();function g(e){(l=cc(new Image,t=>t.src=e.target.value+"/dressed.jpg")).addEventListener("load",e=>{r=scaling(l.naturalWidth,l.naturalHeight,u),a.height=l.naturalHeight*r,o.clearRect(0,0,a.width,a.height),o.drawImage(l,0,0,l.naturalWidth*r,l.naturalHeight*r)}),d=cc(new Image,t=>t.src=e.target.value+"/naked.jpg")}a.width=u.width,i.addEventListener("change",g),g({target:{value:i.value}});var s=.5,h={x:0,y:0};function v(e){move_loupe(e.offsetX||e.layerX,e.offsetY||e.layerY)}move_loupe=((e,t)=>{console.log(r),c.clearRect(0,0,240,240),c.drawImage(d,120-e,120-t,d.naturalWidth*r,d.naturalHeight*r),c.globalAlpha=s,c.drawImage(l,120-e,120-t,l.naturalWidth*r,l.naturalHeight*r),c.globalAlpha=1,n.style.top=t-120+"px",n.style.left=e-120+"px",h.x=e,h.y=t}),a.addEventListener("mousemove",v),n.addEventListener("mousemove",function(e){move_loupe(parseFloat(e.target.style.left)+(e.offsetX||e.layerX),Math.max(parseFloat(e.target.style.top)+(e.offsetY||e.layerY),120))}),a.addEventListener("touchmove",e=>v(e.changedTouches[0])),n.addEventListener("touchmove",e=>v(e.changedTouches[0])),n.addEventListener("wheel",e=>{s+=.001*e.deltaY,move_loupe(h.x,h.y)})});
